{% extends "base.html" %}

{% block title %}IGECH TECH ‚Äî T√©cnicos{% endblock %}

{% block page_css %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/tecnicos.css') }}">
{% endblock %}

{% block content %}
<main class="main-tecnicos">
  <div class="page-header">
    <div>
      <h1 class="hero-title">T√©cnicos</h1>
      <p class="hero-desc">Gerencie e acompanhe todos os t√©cnicos cadastrados no sistema</p>
    </div>
    <!-- Bot√£o principal para abrir o modal de cadastro -->
    <button class="btn-add-tecnico" id="btnAddTecnico">
      <span class="btn-icon">+</span>
      Novo T√©cnico
    </button>
  </div>

  <!-- Cards de resumo (somente total e ativos) -->
  <section class="tecnicos-summary">
    <div class="summary-card">
      <span class="summary-icon summary-blue"></span>
      <div class="summary-info">
        <div class="summary-value" id="total-tecnicos">0</div>
        <div class="summary-label">Total de T√©cnicos</div>
      </div>
    </div>
    <div class="summary-card">
      <span class="summary-icon summary-green"></span>
      <div class="summary-info">
        <div class="summary-value" id="tecnicos-ativos">0</div>
        <div class="summary-label">Ativos</div>
      </div>
    </div>
  </section>

  <!-- Filtros e busca (sem coisas de aloca√ß√£o/dispon√≠vel) -->
  <section class="filter-section">
    <div class="search-box">
      <span class="search-icon"></span>
      <input type="text" placeholder="Buscar por nome, especialidade ou empresa..." class="search-input" id="searchTecnico">
    </div>
    <div class="filter-controls">
      <select class="filter-select" id="filterEspecialidade">
        <option value="">Todas as Especialidades</option>
        <option value="Hardware">Hardware</option>
        <option value="Software">Software</option>
        <option value="Redes">Redes</option>
        <option value="Suporte">Suporte</option>
      </select>
      <select class="filter-select" id="filterStatus">
        <option value="">Todos os Status</option>
        <option value="ativo">Ativo</option>
        <option value="inativo">Inativo</option>
      </select>
    </div>
  </section>

  <!-- Tabela de t√©cnicos (SEM coluna de aloca√ß√µes) -->
  <section class="tecnicos-table-section">
    <div class="table-header">
      <h2 class="section-title">Lista de T√©cnicos</h2>
      <!-- Mostra quantos t√©cnicos est√£o aparecendo na tabela ap√≥s filtro -->
      <span class="table-count" id="tableCount">0 t√©cnicos encontrados</span>
    </div>
    <div class="table-wrapper">
      <table class="tecnicos-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Especialidade</th>
            <th>N√≠vel</th>
            <th>üí∞ R$/hora</th>
            <th>Empresa Atual</th>
            <th>Status</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="tecnicosTableBody">
          <tr class="empty-state">
            <td colspan="8">
              <div class="empty-message">
                <span class="empty-icon"></span>
                <p>Nenhum t√©cnico cadastrado ainda</p>
                <button class="btn-empty-action" onclick="document.getElementById('btnAddTecnico').click()">
                  Cadastrar Primeiro T√©cnico
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Cards de informa√ß√µes gerais (sem falar de aloca√ß√£o/dispon√≠vel) -->
  <section class="info-cards">
    <div class="info-card">
      <span class="info-icon info-blue"></span>
      <div>
        <div class="info-title">Gest√£o de T√©cnicos</div>
        <div class="info-desc">Cadastre, atualize e mantenha o controle dos profissionais da sua opera√ß√£o.</div>
      </div>
    </div>
    <div class="info-card">
      <span class="info-icon info-cyan"></span>
      <div>
        <div class="info-title">Informa√ß√µes Centralizadas</div>
        <div class="info-desc">Dados de contato, especialidade e valor hora em um s√≥ lugar.</div>
      </div>
    </div>
    <div class="info-card">
      <span class="info-icon info-violet"></span>
      <div>
        <div class="info-title">Hist√≥rico Organizado</div>
        <div class="info-desc">Mantenha um registro completo dos t√©cnicos da sua empresa.</div>
      </div>
    </div>
  </section>
</main>

<!-- Modal: Cadastro/Edi√ß√£o/Visualiza√ß√£o de T√©cnico -->
<div id="modalTecnico" class="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modalTecnicoTitle">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title" id="modalTecnicoTitle">Cadastrar T√©cnico</h3>
      <button type="button" class="close-modal" id="closeModalTecnico" aria-label="Fechar">√ó</button>
    </div>

    <form id="formTecnico" autocomplete="off">
      <div class="form-grid">
        <!-- Nome -->
        <div class="field">
          <label for="tecNome">Nome *</label>
          <input type="text" id="tecNome" name="nome" required>
        </div>

        <!-- Email -->
        <div class="field">
          <label for="tecEmail">Email</label>
          <input type="email" id="tecEmail" name="email" placeholder="opcional">
        </div>

        <!-- Telefone -->
        <div class="field">
          <label for="tecTelefone">Telefone</label>
          <input type="tel" id="tecTelefone" name="telefone" placeholder="(00) 00000-0000">
        </div>

        <!-- Especialidade -->
        <div class="field">
          <label for="tecEspecialidade">Especialidade *</label>
          <select id="tecEspecialidade" name="especialidade" required>
            <option value="">Selecione</option>
            <option value="Hardware">Hardware</option>
            <option value="Software">Software</option>
            <option value="Redes">Redes</option>
            <option value="Suporte">Suporte</option>
          </select>
        </div>

        <!-- N√≠vel de Experi√™ncia -->
        <div class="field">
          <label for="tecNivelExp">N√≠vel de Experi√™ncia *</label>
          <select id="tecNivelExp" name="nivel_experiencia" required>
            <option value="Junior">Junior</option>
            <option value="Pleno">Pleno</option>
            <option value="Senior">Senior</option>
          </select>
        </div>

        <!-- Pre√ßo por Hora -->
        <div class="field">
          <label for="tecPrecoHora">üí∞ Pre√ßo por Hora (R$) *</label>
          <input
            type="number"
            id="tecPrecoHora"
            name="preco_hora"
            step="0.01"
            min="0"
            max="9999.99"
            value="100.00"
            placeholder="100.00"
            required>
          <div class="help">Valor cobrado por hora de servi√ßo.</div>
        </div>

        <!-- Empresa atual  -->
        <div class="field full">
          <label for="tecEmpresa">Empresa (atual)</label>
          <select id="tecEmpresa" name="id_empresa_cliente">
            <option value="">Nenhuma empresa vinculada</option>
          </select>
          <div class="help">Opcional: vincule o t√©cnico a uma empresa cliente.</div>
        </div>

        <!-- Status: apenas ativo/inativo -->
        <div class="field">
          <label for="tecStatus">Status *</label>
          <select id="tecStatus" name="status" required>
            <option value="ativo">Ativo</option>
            <option value="inativo">Inativo</option>
          </select>
        </div>

        <!-- Observa√ß√µes gerais -->
        <div class="field full">
          <label for="tecObs">Observa√ß√µes</label>
          <textarea id="tecObs" name="observacoes" rows="3" placeholder="Informa√ß√µes adicionais"></textarea>
        </div>
      </div>

      <div class="error-text" id="tecError"></div>

      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" id="btnCancelTecnico">Cancelar</button>
        <button type="submit" class="btn btn-primary" id="btnSaveTecnico">Salvar</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block page_js %}
  <script src="{{ url_for('static', filename='js/tecnicos.js') }}"></script>
{% endblock %}
