{% extends "base.html" %}

{% block title %}IGECH TECH ‚Äî Empresas{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/empresas.css') }}">
{% endblock %}

{% block content %}
<main class="main-empresas">

  <div class="page-header">
    <div>
      <h1 class="hero-title">Empresas</h1>
      <p class="hero-desc">Gerencie e acompanhe todas as empresas cadastradas no sistema.</p>
    </div>
    <button class="btn-add-empresa" id="btnAddEmpresa" type="button">
      <span class="btn-icon">+</span>Nova Empresa
    </button>
  </div>

  <div class="empresas-summary">
    <div class="summary-card">
      <div class="summary-icon summary-violet"></div>
      <div>
        <div class="summary-value" id="total-empresas">0</div>
        <div class="summary-label">Total de Empresas</div>
      </div>
    </div>
    <div class="summary-card">
      <div class="summary-icon summary-blue"></div>
      <div>
        <div class="summary-value" id="empresas-ativas">0</div>
        <div class="summary-label">Ativas</div>
      </div>
    </div>
    <div class="summary-card">
      <div class="summary-icon summary-cyan"></div>
      <div>
        <div class="summary-value" id="empresas-contratos">0</div>
        <div class="summary-label">Com Contrato</div>
      </div>
    </div>
    <div class="summary-card">
      <div class="summary-icon summary-violet"></div>
      <div>
        <div class="summary-value" id="empresas-sem-contrato">0</div>
        <div class="summary-label">Sem Contrato</div>
      </div>
    </div>
  </div>

  <section class="filter-section">
    <div class="search-box">
      <span class="search-icon"></span>
      <input type="text" id="searchEmpresa" placeholder="Buscar por nome, CNPJ ou email..." class="search-input">
    </div>
    <div class="filter-controls">
      <select class="filter-select" id="filterContrato">
        <option value="">Todos os Contratos</option>
        <option value="ativo">Com Contrato</option>
        <option value="inativo">Sem Contrato</option>
      </select>
    </div>
  </section>

  <section class="empresas-table-section">
    <div class="table-header">
      <h2 class="section-title">Lista de Empresas</h2>
      <span class="table-count" id="tableCountEmpresas">0 empresas encontradas</span>
    </div>
    <div class="table-wrapper">
      <table class="empresas-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>CNPJ</th>
            <th>Email</th>
            <th>Telefone</th>
            <th>Endere√ßo</th>
            <th>Contratos</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="empresasTableBody">
          <tr class="empty-state">
            <td colspan="8">
              <div class="empty-message">
                <span class="empty-icon"></span>
                <p>Nenhuma empresa cadastrada ainda</p>
                <button class="btn-empty-action" onclick="document.getElementById('btnAddEmpresa').click()">
                  Cadastrar Primeira Empresa
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>
</main>

<div id="modalEmpresa" class="modal" aria-hidden="true">
  <div class="modal-content">
    <button class="close-modal" type="button" id="closeModalEmpresa">&times;</button>
    <h2 class="modal-title" id="modalEmpresaTitle">Cadastrar Empresa</h2>
    <form id="formEmpresa" autocomplete="off">
      <fieldset class="form-section">
        <legend class="section-legend">Dados da Empresa</legend>
        <div class="form-grid">
          <div class="field full">
            <label for="empresaNome">Nome da Empresa <span class="required">*</span></label>
            <input type="text" id="empresaNome" name="nome_empresa" required placeholder="Ex: Empresa LTDA">
          </div>
          <div class="field">
            <label for="empresaCnpj">CNPJ</label>
            <input type="text" id="empresaCnpj" name="cnpj" placeholder="00.000.000/0000-00" maxlength="18">
          </div>
          <div class="field">
            <label for="empresaEmail">Email</label>
            <input type="email" id="empresaEmail" name="email" placeholder="contato@empresa.com">
          </div>
          <div class="field">
            <label for="empresaTelefone">Telefone</label>
            <input type="tel" id="empresaTelefone" name="telefone" placeholder="(00) 0000-0000" maxlength="15">
          </div>
        </div>
      </fieldset>
      <fieldset class="form-section">
        <legend class="section-legend">Endere√ßo</legend>
        <div class="form-grid">
          <div class="field field-cep" style="position: relative;">
            <label for="empresaCep">CEP</label>
            <input type="text" id="empresaCep" name="cep" placeholder="00000-000" maxlength="9" autocomplete="postal-code">
            <button type="button" class="btn-buscar-cep" id="btnBuscarCep" title="Buscar CEP">üîç</button>
          </div>
          <div class="field">
            <label for="empresaTipoLogradouro">Tipo</label>
            <select id="empresaTipoLogradouro" name="tipo_logradouro">
              <option value="">Selecione</option>
              <option value="Rua">Rua</option>
              <option value="Avenida">Avenida</option>
              <option value="Travessa">Travessa</option>
              <option value="Alameda">Alameda</option>
              <option value="Pra√ßa">Pra√ßa</option>
              <option value="Rodovia">Rodovia</option>
              <option value="Estrada">Estrada</option>
              <option value="Viela">Viela</option>
              <option value="Largo">Largo</option>
            </select>
          </div>
          <div class="field field-2-3">
            <label for="empresaNomeLogradouro">Nome do Endere√ßo</label>
            <input type="text" id="empresaNomeLogradouro" name="nome_logradouro" placeholder="Ex: das Flores, Paulista" maxlength="120" autocomplete="address-line1">
          </div>
          <div class="field field-1-3">
            <label for="empresaNumero">N√∫mero</label>
            <input type="text" id="empresaNumero" name="numero" placeholder="123">
          </div>
          <div class="field full">
            <label for="empresaComplemento">Complemento</label>
            <input type="text" id="empresaComplemento" name="complemento" placeholder="Sala, Andar, Bloco (opcional)" autocomplete="address-line2">
          </div>
          <div class="field">
            <label for="empresaBairro">Bairro</label>
            <input type="text" id="empresaBairro" name="bairro" placeholder="Centro, Jardim, etc.">
          </div>
          <div class="field">
            <label for="empresaCidade">Cidade</label>
            <input type="text" id="empresaCidade" name="cidade" placeholder="Nome da cidade">
          </div>
          <div class="field field-estado">
            <label for="empresaEstado">Estado</label>
            <select id="empresaEstado" name="estado">
              <option value="">Selecione</option>
              <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option>
              <option value="BA">BA</option><option value="CE">CE</option><option value="DF">DF</option><option value="ES">ES</option>
              <option value="GO">GO</option><option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
              <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option>
              <option value="PE">PE</option><option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option>
              <option value="RS">RS</option><option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
              <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
            </select>
          </div>
        </div>
      </fieldset>
      <div class="error-text" id="empresaError"></div>
      <div class="modal-footer">
        <button type="button" class="btn btn-cancel" id="btnCancelEmpresa">Cancelar</button>
        <button type="submit" class="btn btn-primary" id="btnSaveEmpresa">Salvar</button>
      </div>
    </form>
  </div>
</div>

<div id="modalUsuariosEmpresa" class="modal" aria-hidden="true">
  <div class="modal-content">
    <button class="close-modal" type="button" id="closeModalUsuariosEmpresa">&times;</button>
    <h2 class="modal-title" id="modalUsuariosEmpresaTitle">Usu√°rios da Empresa</h2>
    <div class="modal-body">
      <div class="usuarios-list" id="usuariosEmpresaCardBody">
        <div class="loading-state">Carregando usu√°rios...</div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block page_js %}
  <script src="{{ url_for('static', filename='js/modals.js') }}"></script>
  <script src="{{ url_for('static', filename='js/empresas.js') }}"></script>
{% endblock %}
